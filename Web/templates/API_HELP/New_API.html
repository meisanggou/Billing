{% extends "base.html" %}

{% block title %}添加API{% endblock %}

{% block content %}
<div class="container apiMode">
    {% if return_url %}
        <a class="btn btn-primary pull-right" href="{{ return_url }}" title="">查看API</a>
    {% else %}
        <a class="btn btn-primary pull-right" href="{{ url_prefix }}/" title="">API列表</a>
    {% endif %}
  <div class="form-group">
     <label for="">API所属模块：</label>
     <select class="box-side" id="api_module" onchange="select_change()" >
        {% for part in part_module %}
            {% for module in part["module_list"] %}
                {% if module["module_no"] == module_no  %}
                    <option about="{{ module["module_desc"] }}" value="{{ module["module_no"] }}" title="{{ module["module_prefix"] }}" selected="selected">{{ module["module_name"] }}</option>
                {% else %}
                    <option about="{{ module["module_desc"] }}" value="{{ module["module_no"] }}" title="{{ module["module_prefix"] }}">{{ module["module_name"] }}</option>
                {% endif %}
            {% endfor %}
        {% endfor %}
     </select>
  </div>
{% if api_info %}
  <form role="form" action="{{ url_prefix }}/update/" method="post">
     <div class="form-group apiContentLine">
      <label for="">选择的模块是：</label>
      <ul class="select-mode">
        <li>
          <label for="">模块编号：</label>
          <span id="selected_no"></span>
          <input id="module_no" name="api_module" style="display:none;" value=""/>
        </li>
        <li>
          <label for="">模块名称：</label>
          <span id="selected_name"></span></li>
        <li>
          <label for="">模块URL前缀：</label>
          <span id="selected_prefix"></span></li>
        <li>
          <label for="">模块描述：</label>
          <span id="selected_desc"></span></li>
      </ul>
    </div>
    <div class="form-group apiContentLine">
      <ul>
        <li>
          <label for="">API标题：</label>
          <input class="box-side width300" name="api_title" type="text" value="{{ api_info["basic_info"]["api_title"] }}" />
        </li>
        <li>
          <label for="">API访问路径：</label>
          <input class="box-side width300" name="api_url" type="text" id="api_url" onkeyup="show_comp_url();" value="{{ api_info["basic_info"]["api_path"] }}" />
          <label id="api_comp_url"></label>
        </li>
        <li>
          <label for="">API请求方式：</label>
          <select class="box-side width300" name="api_method">
          {% for http_method in ["GET", "POST", "PUT", "DELETE"] %}
            <option {% if api_info["basic_info"]["api_method"] == http_method %} selected="selected" {% endif %}>{{ http_method }}</option>
          {% endfor %}
          </select>
        </li>
        <li>
          <label class="api-describe" for="">API描述：</label>
          <textarea class="box-side" rows="3" name="api_desc">{{ api_info["basic_info"]["api_desc"] }}</textarea>
        </li>
      </ul>
    </div>
    <input name="api_no" value="{{ api_info["basic_info"]["api_no"] }}" style="display: none">
    <button type="submit" class="btn btn-success btn-down api-newBtn">更新</button>
  </form>
{% else %}
  <form role="form" action="{{ url_prefix }}/new/" method="post">
     <div class="form-group apiContentLine">
      <label for="">选择的模块是：</label>
      <ul class="select-mode">
        <li>
          <label for="">模块编号：</label>
          <span id="selected_no"></span>
          <input id="module_no" name="api_module" style="display:none;" value=""/>
        </li>
        <li>
          <label for="">模块名称：</label>
          <span id="selected_name"></span></li>
        <li>
          <label for="">模块URL前缀：</label>
          <span id="selected_prefix"></span></li>
        <li>
          <label for="">模块描述：</label>
          <span id="selected_desc"></span></li>
      </ul>
    </div>
    <div class="form-group apiContentLine">
      <ul>
        <li>
          <label for="">API标题：</label>
          <input class="box-side width300" name="api_title" type="text" />
        </li>
        <li>
          <label for="">API访问路径：</label>
          <input class="box-side width300" name="api_url" type="text" id="api_url" onkeyup="show_comp_url();" />
          <label id="api_comp_url"></label>
        </li>
        <li>
          <label for="">API请求方式：</label>
          <select class="box-side width300" name="api_method">
            <option>GET</option>
            <option>POST</option>
            <option>PUT</option>
            <option>DELETE</option>
          </select>
        </li>
        <li>
          <label class="api-describe" for="">API描述：</label>
          <textarea class="box-side" rows="3" name="api_desc"></textarea>
        </li>
      </ul>
    </div>
    <button type="submit" class="btn btn-success btn-down api-newBtn">新建</button>
  </form>

{% endif %}
<script type="text/javascript" src="{{ 't_js/API_HELP/new_api.js' | make_static_url }}"></script>
</div>
{% endblock %}

