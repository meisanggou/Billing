<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>更新API解释</title>
<link rel="stylesheet" href="{{ url_for('static', filename='t_css/bootstrap.min.css') }}"><!-- 新 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="{{ url_for('static', filename='t_css/main.css') }}"><!--自定义的页面样式 -->
<script type="text/javascript" src="{{ url_for('static', filename='t_js/jquery.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='t_js/API_HELP/update_api.js') }}"></script>
</head>

<body onbeforeunload="send_message();">
    <div class="pull-left" style="position:fixed;width: 50px;padding-top: 100px"></div>
    <div class="container font16 apiMode">
        <a class="btn btn-primary pull-right" href="{{ return_url }}" title="">返回</a>
        <input class="form-control bottom10" id="api_no" value="{{ api_no }}" style="display:none;"/>
        <p>API标题: {{ api_info["basic_info"]["api_title"] }}</p>
        <p>API URL: {{ api_info["basic_info"]["api_url"] }}</p>
        <p>API 请求方式: {{ api_info["basic_info"]["api_method"] }}</p>
        <p>API 状态: {{ api_status_desc[api_info["basic_info"]["status"]] }}</p>
        <a href="{{ url_prefix }}/update/?api_no={{ api_info["basic_info"]["api_no"] }}">更新API信息</a>&nbsp;
        {% if api_info["basic_info"]["status"] < 2 %}
            <a href="{{ url_prefix }}/update/completed/">设置完成</a>
        {% elif api_info["basic_info"]["status"] == 2 %}
            <a href="{{ url_prefix }}/update/modify/">设置为修改中</a>
        {% endif %}
        <!-- Button trigger modal -->
{#        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal">#}
{#            Launch demo modal#}
{#        </button>#}
        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                    </div>
                    <div class="modal-body">
                        <textarea class="text-content" name="" cols="" rows=""></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-info">确定</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>

        <input id="del_header_url" value="{{ url_prefix }}/delete/header/" style="display: none" />
        <input id="del_body_url" value="{{ url_prefix }}/delete/body/" style="display: none" />
        <input id="del_input_url" value="{{ url_prefix }}/delete/input/" style="display: none" />
        <input id="del_output_url" value="{{ url_prefix }}/delete/output/" style="display: none" />
        <input id="update_header_url" value="{{ url_prefix }}/update/header/" style="display: none" />
        <table class="table table-bordered api-list-table" id="api_header_param">
            <caption>请求头部参数</caption>
            <tr>
                <th scope="col" width="25%">参数名称</th>
                <th scope="col" width="8%">是否必须</th>
                <th scope="col" width="55%">参数描述</th>
                <th scope="col" width="12%">操作</th>
            </tr>
            {% for item in api_info["header_info"] %}
            <tr id="tr_{{ item["api_no"] }}{{ item["param"] }}">
                <td>{{ item["param"] }}</td>
                <td>
                    <select class="form-control" disabled>
                        <option value="1" {% if item["necessary"] %}selected="selected"{% endif %}>是</option>
                        <option value="0" {% if not item["necessary"] %}selected="selected"{% endif %}>否</option>
                    </select>
                </td>
                <td>{{ item["param_desc"] }}</td>
                <td>
                    <button class="btn btn-success">更新</button>
                    <button class="btn btn-danger" onclick="delete_header_param('{{ item["api_no"] }}','{{ item["param"] }}')">删除</button>
                </td>
            </tr>
            {% endfor %}
                <td><input class="form-control" id="header_param_name"/></td>
                <td>
                    <select class="form-control" id="header_param_ne">
                        <option value="1">是</option>
                        <option value="0">否</option>
                    </select>
                </td>
                <td><input class="form-control" id="header_param_desc" placeholder="如果你不想既浪费了写文档的时间，还得浪费时间给前端解释。请写的傻子都能看懂" /></td>
                <td><button class="btn btn-info" onclick="new_header_param('{{ url_prefix }}/add/header/');">新建</button></td>

        </table>
        {% for item in api_info["predefine_header"] %}
            {% if item in api_info["predefine_param"]["header"] %}
                <button id="pp_{{ item }}" class="btn btn-danger" onclick="handle_predefine_param(this.id);" title="{{ api_info["predefine_header"][item]["param_desc"] }}" value="{{ item }}">不需要{{ item }}</button>
            {% else %}
                <button id="pp_{{ item }}" class="btn btn-info" onclick="handle_predefine_param(this.id);" title="{{ api_info["predefine_header"][item]["param_desc"] }}" value="{{ item }}">需要{{ item }}</button>
            {% endif %}
        {% endfor %}
        <table class="table table-bordered api-list-table" id="api_body_param">
            <caption>请求主体参数</caption>
            <tr>
                <th scope="col" width="25%">参数名称</th>
                <th scope="col" width="8%">是否必须</th>
                <th scope="col" width="10%">参数类型</th>
                <th scope="col" width="45%">参数描述</th>
                <th scope="col" width="11%">操作</th>
            </tr>
            {% for item in api_info["body_info"] %}
            <tr id="trb_{{ item["api_no"] }}{{ item["param"] }}">
                <td>{{ item["param"] }}</td>
                <td>{% if item["necessary"] %}是{% else %}否{% endif %}</td>
                <td>{{ item["type"] }}</td>
                <td>{{ item["param_desc"] }}</td>
                <td>
                   <button class="btn btn-success" onclick="update_body_param('{{ item["api_no"] }}','{{ item["param"] }}')">更新</button>
                   <button class="btn btn-danger" onclick="delete_body_param('{{ item["api_no"] }}','{{ item["param"] }}')">删除</button>
                </td>
            </tr>
            {% endfor %}
                <td><input class="form-control" id="body_param_name"/></td>
                <td>
                    <select class="form-control" id="body_param_ne">
                        <option value="1">是</option>
                        <option value="0">否</option>
                    </select>
                </td>
                <td>
                    <select class="form-control" id="body_param_type">
                        <option value="string">string</option>
                        <option value="int">int</option>
                        <option value="list">list</option>
                        <option value="object">object</option>
                        <option value="bool">bool</option>
                    </select>
                </td>
                <td><input class="form-control" id="body_param_desc" placeholder="请详细的描述出后端对参数的限制，包括但不限于字段长度，字符限制等" /></td>
                <td><button class="btn btn-info" onclick="new_body_param('{{ url_prefix }}/add/body/');">新建</button></td>
        </table>

        <div class="bottom20 api-example">
            <b>请求示例</b>
            <div id="api_input_exist">
                {% for item in api_info["input_info"] %}
                <div id="div_{{ item["input_no"] }}">
                   <p>{{ item["input_desc"] }}</p>
                   <p><textarea class="form-control" readonly>{{ item["input_example"] }}</textarea></p>
                   <p><button class="btn btn-success">更新</button>
                   <button class="btn btn-danger" onclick="delete_input_param('{{ item["input_no"] }}')">删除</button></p>
                </div>
                {% endfor %}
            </div>
            <p><input class="form-control" id="input_desc" placeholder="请求示例描述"  /></p>
            <p><textarea class="form-control input_example" id="input_example" onchange="format_input(this.id);" onkeyup="format_input(this.id);" placeholder="请求示例，写成符合json格式。解释示例，请在描述中解释"></textarea></p>
            <button class="btn btn-info" onclick="new_input_example('{{ url_prefix }}/add/input/')">新建</button>

        </div>

        <div class="bottom20 api-example">
            <b>返回示例</b>
            <div id="api_output_exist">
                {% for item in api_info["output_info"] %}
                   <div id="div_{{ item["output_no"] }}">
                       <p>{{ item["output_desc"] }}</p>
                       <p><textarea class="form-control" readonly>{{ item["output_example"] }}</textarea></p>
                       <p><button class="btn btn-success">更新</button>
                       <button class="btn btn-danger" onclick="delete_output_param('{{ item["output_no"] }}')">删除</button></p>
                   </div>
                {% endfor %}
            </div>
            <p><input class="form-control" id="output_desc" placeholder="返回示例描述" /></p>
            <p><textarea class="form-control input_example" id="output_example" onchange="format_input(this.id);" onkeyup="format_input(this.id);" placeholder="返回示例，写成符合json格式。解释示例，请在描述中解释。所有完成后请将API状态置为完成"></textarea></p>
            <button class="btn btn-info" onclick="new_output_example('{{ url_prefix }}/add/output/')">新建</button>

        </div>


    </div>

<script type="text/javascript" src="{{ url_for('static', filename='t_js/bootstrap.min.js') }}"></script>

</body>
</html>