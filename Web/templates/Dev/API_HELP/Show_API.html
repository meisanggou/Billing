<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>查看API解释</title>
<link rel="stylesheet" href="{{ url_for('static', filename='t_css/bootstrap.min.css') }}"><!-- 新 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="{{ url_for('static', filename='t_css/main.css') }}"><!--自定义的页面样式 -->
<script type="text/javascript" src="{{ url_for('static', filename='t_js/jquery.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='t_js/API_HELP/show_api.js') }}"></script>
</head>

<body>
<div class="container font16 apiMode">
    <a class="btn btn-primary pull-right" href="{{ return_url }}" title="">API列表</a>
    {% if update_url %}
    <a class="btn btn-primary pull-right margin10" href="{{ update_url }}" title="">修改</a>
    {% endif %}
    {% if test_url %}
    <a class="btn btn-primary pull-right margin10" href="{{ test_url }}" title="">测试API</a>
    {% endif %}
    <div class="clear"></div>
    <input class="form-control bottom10" id="api_no" value="{{ api_no }}" style="display:none;"/>
    <p>API标题: {{ api_info["basic_info"]["api_title"] }}</p>
    <p>API URL: {{ api_info["basic_info"]["api_url"] }}</p>
    <p>API 请求方式: {{ api_info["basic_info"]["api_method"] }}</p>
    <p>API 描述: {{ api_info["basic_info"]["api_desc"] }}</p>
{% if api_info["header_info"] | length > 0 %}
<table class="table table-bordered api-list-table" id="api_header_param">
    <caption>请求头部参数</caption>
    <tr>
        <th scope="col" width="40%">参数名称</th>
        <th class="text-center" scope="col" width="8%">是否必须</th>
        <th scope="col" width="40%">参数描述</th>
    </tr>
    {% for item in api_info["header_info"] %}
    <tr>
        <td>{{ item["param"] }}</td>
        <td class="text-center">
            {% if item["necessary"] %}
                是
            {% else %}
                否
            {% endif %}
        </td>
        <td>{{ item["param_desc"] }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if api_info["body_info"] | length > 0 %}
<table class="table table-bordered api-list-table" id="api_body_param">
    <caption>请求主体参数</caption>
    <tr>
        <th scope="col" width="25%">参数名称</th>
        <th class="text-center" scope="col" width="8%">是否必须</th>
        <th class="text-center" scope="col" width="10%">参数类型</th>
        <th scope="col" width="45%">参数描述</th>
    </tr>
    {% for item in api_info["body_info"] %}
    <tr>
        <td>{{ item["param"] }}</td>
        <td class="text-center">
            {% if item["necessary"] %}
                是
            {% else %}
                否
            {% endif %}
        </td>
        <td class="text-center">{{ item["type"] }}</td>
        <td>{{ item["param_desc"] }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if api_info["input_info"] | length > 0 %}
<div class="bottom20 api-example">
    <b>请求示例</b>
    <div id="api_input_exist">
        {% for item in api_info["input_info"] %}
        <div>
           <p>{{ item["input_desc"] }}</p>
           <p><textarea class="form-control" readonly>{{ item["input_example"] }}</textarea></p>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% if api_info["output_info"] | length > 0 %}
<div class="bottom20 api-example">
    <b>返回示例</b>
    <div id="api_output_exist">
        {% for item in api_info["output_info"] %}
           <p>{{ item["output_desc"] }}</p>
           <p><textarea class="form-control" readonly>{{ item["output_example"] }}</textarea></p>
        {% endfor %}
    </div>
</div>
{% endif %}

<div class="care">
    {% if my_care %}
       <button class="btn btn-primary pull-right" onclick="change_care();" id="make_care">取消关注</button>
    {% else %}
        <button class="btn btn-primary pull-right" onclick="change_care();" id="make_care">关注</button>
    {% endif %}
    <p><b>已关注的人</b></p>
    <div id="api_care_user">
        {% if my_care %}
            <span id="mine_care">我</span>
        {% endif %}
        {% for item in api_info["care_info"] %}
        <span>{{ item["nick_name"] }}</span>
        {% endfor %}
    </div>
</div>
{% if my_care and my_care["level"] == 0 %}
<form action="/dev/api/delete/{{ api_no }}/" method="get">
    <button class="btn btn-primary pull-right" >删除API</button>
</form>
{% endif %}

</div>

</body>
</html>